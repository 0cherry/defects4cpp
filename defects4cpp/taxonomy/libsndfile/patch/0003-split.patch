From b972af8eff4b2d67c10be6114bf881d8c4b0d9f4 Mon Sep 17 00:00:00 2001
From: haku <gentlebuuny@gmail.com>
Date: Fri, 16 Jul 2021 09:34:24 +0900
Subject: [PATCH] split tests

---
 tests/aiff_rw_test.c          |   6 +
 tests/alaw_test.c             |   6 +
 tests/channel_test.c          |   8 +-
 tests/checksum_test.c         |   5 +
 tests/chunk_test.c            |  26 +-
 tests/command_test.c          | 114 +++++++-
 tests/compression_size_test.c |  14 +-
 tests/cpp_test.cc             |  15 +
 tests/defects4cpp.h           |  11 +
 tests/defects4cpp.lua         |   1 +
 tests/dither_test.c           |  75 ++++-
 tests/dwvw_test.c             |   9 +
 tests/error_test.c            |  15 +
 tests/external_libs_test.c    |   9 +
 tests/fix_this.c              |   5 +
 tests/format_check_test.c     |   7 +
 tests/headerless_test.c       |  13 +
 tests/largefile_test.c        |   7 +
 tests/locale_test.c           |   7 +
 tests/lossy_comp_test.c       | 499 ++++++++++++++++++++++++++++++++--
 tests/misc_test.c             | 115 ++++++--
 tests/multi_file_test.c       |  20 +-
 tests/ogg_test.c              |   5 +
 tests/peak_chunk_test.c       |  20 +-
 tests/raw_test.c              |   7 +
 tests/sftest.c                |   5 +
 tests/stdin_test.c            |  86 +++++-
 tests/string_test.c           |  60 +++-
 tests/ulaw_test.c             |   6 +
 tests/virtual_io_test.c       |  12 +
 tests/win32_ordinal_test.c    |   6 +
 tests/win32_test.c            |   6 +
 32 files changed, 1100 insertions(+), 100 deletions(-)
 create mode 100644 tests/defects4cpp.h
 create mode 100644 tests/defects4cpp.lua

diff --git a/tests/aiff_rw_test.c b/tests/aiff_rw_test.c
index 43d34dbc..6fd1f0f1 100644
--- a/tests/aiff_rw_test.c
+++ b/tests/aiff_rw_test.c
@@ -28,6 +28,7 @@
 #include <sndfile.h>
 
 #include "utils.h"
+#include "defects4cpp.h"
 
 
 static unsigned char aifc_data [] =
@@ -96,7 +97,12 @@ main (void)
 
 	dump_data_to_file (filename, aifc_data, sizeof (aifc_data)) ;
 
+	switch (defects4cpp_test_index ())
+	{
+		case 1:
 	rw_test (filename) ;
+			break ;
+	}
 
 	unlink (filename) ;
 
diff --git a/tests/alaw_test.c b/tests/alaw_test.c
index 6d71ffed..d0cff87d 100644
--- a/tests/alaw_test.c
+++ b/tests/alaw_test.c
@@ -29,6 +29,7 @@
 #include <sndfile.h>
 
 #include "utils.h"
+#include "defects4cpp.h"
 
 #define	BUFFER_SIZE		(65536)
 
@@ -51,6 +52,9 @@ main (void)
 
 	sf_info_setup (&sfinfo, SF_FORMAT_RAW | SF_FORMAT_ALAW, 44100, 1) ;
 
+	switch (defects4cpp_test_index ())
+	{
+		case 2:
 	if ((file = sf_open (filename, SFM_WRITE, &sfinfo)) == NULL)
 	{	printf ("sf_open_write failed with error : ") ;
 		fflush (stdout) ;
@@ -144,6 +148,8 @@ main (void)
 
 	unlink (filename) ;
 
+			break ;
+	}
 	return 0 ;
 } /* main */
 
diff --git a/tests/channel_test.c b/tests/channel_test.c
index 8a697343..c747f2b2 100644
--- a/tests/channel_test.c
+++ b/tests/channel_test.c
@@ -34,6 +34,7 @@
 #include <sndfile.h>
 
 #include "utils.h"
+#include "defects4cpp.h"
 
 #define	BUFFER_LEN		(1 << 10)
 #define LOG_BUFFER_SIZE	1024
@@ -43,7 +44,12 @@ static	double	max_diff		(const float *a, const float *b, int len) ;
 
 int
 main (void) // int argc, char *argv [])
-{	channel_test () ;
+{
+	switch (defects4cpp_test_index ()) {
+		case 3:
+	channel_test () ;
+			break ;
+	}
 	return 0 ;
 } /* main */
 
diff --git a/tests/checksum_test.c b/tests/checksum_test.c
index b44ad8e3..e77a9299 100644
--- a/tests/checksum_test.c
+++ b/tests/checksum_test.c
@@ -26,6 +26,7 @@
 #include <sndfile.h>
 
 #include "utils.h"
+#include "defects4cpp.h"
 
 #define	SAMPLE_RATE	8000
 
@@ -71,8 +72,12 @@ main (void)
 
 	gen_windowed_sine_float (orig, ARRAY_LEN (orig), 0.9) ;
 
+	switch (defects4cpp_test_index ()) {
+		case 4:
 	for (k = 0 ; k < ARRAY_LEN (checksum_orig) ; k++)
 		checksum_test (&checksum_orig [k]) ;
+			break ;
+	}
 
 	return 0 ;
 } /* main */
diff --git a/tests/chunk_test.c b/tests/chunk_test.c
index 5a036b1e..6c3507d2 100644
--- a/tests/chunk_test.c
+++ b/tests/chunk_test.c
@@ -30,6 +30,7 @@
 #include	<sndfile.h>
 
 #include	"utils.h"
+#include	"defects4cpp.h"
 
 #define	BUFFER_LEN			(1 << 10)
 #define LOG_BUFFER_SIZE		1024
@@ -55,21 +56,40 @@ main (int argc, char *argv [])
 
 	do_all = ! strcmp (argv [1], "all") ;
 
+	int index = defects4cpp_test_index () ;
 	if (do_all || ! strcmp (argv [1], "wav"))
-	{	chunk_test ("chunks_pcm16.wav", SF_FORMAT_WAV | SF_FORMAT_PCM_16) ;
+	{ switch (index) {
+			case 5:
+		chunk_test ("chunks_pcm16.wav", SF_FORMAT_WAV | SF_FORMAT_PCM_16) ;
+				break ;
+			case 6:
 		chunk_test ("chunks_pcm16.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV | SF_FORMAT_PCM_16) ;
+				break ;
+			case 7:
 		chunk_test ("chunks_pcm16.wavex", SF_FORMAT_WAVEX | SF_FORMAT_PCM_16) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "aiff"))
-	{	chunk_test ("chunks_pcm16.aiff", SF_FORMAT_AIFF | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 8:
+		chunk_test ("chunks_pcm16.aiff", SF_FORMAT_AIFF | SF_FORMAT_PCM_16) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "caf"))
-	{	chunk_test ("chunks_pcm16.caf", SF_FORMAT_CAF | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 9:
+		chunk_test ("chunks_pcm16.caf", SF_FORMAT_CAF | SF_FORMAT_PCM_16) ;
+				break ;
+			case 10:
 		chunk_test ("chunks_alac.caf", SF_FORMAT_CAF | SF_FORMAT_ALAC_16) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
diff --git a/tests/command_test.c b/tests/command_test.c
index 1596bcba..a3921490 100644
--- a/tests/command_test.c
+++ b/tests/command_test.c
@@ -34,6 +34,7 @@
 #include <sndfile.h>
 
 #include "utils.h"
+#include "defects4cpp.h"
 
 #define	BUFFER_LEN		(1 << 10)
 #define LOG_BUFFER_SIZE	1024
@@ -90,9 +91,12 @@ main (int argc, char *argv [])
 
 	do_all = ! strcmp (argv [1], "all") ;
 
+	int index = defects4cpp_test_index () ;
 	if (do_all || strcmp (argv [1], "ver") == 0)
 	{	char buffer [128] ;
 
+		switch (index) {
+			case 11:
 		print_test_name ("version_test", "(none)") ;
 		buffer [0] = 0 ;
 		sf_command (NULL, SFC_GET_LIB_VERSION, buffer, sizeof (buffer)) ;
@@ -101,6 +105,8 @@ main (int argc, char *argv [])
 			exit (1) ;
 			} ;
 		puts ("ok") ;
+				break ;
+		}
 		test_count ++ ;
 		} ;
 
@@ -108,82 +114,170 @@ main (int argc, char *argv [])
 	{	/*	Preliminary float/double normalisation tests. More testing
 		**	is done in the program 'floating_point_test'.
 		*/
+		switch (index) {
+			case 12:
 		float_norm_test		("float.wav") ;
+				break ;
+			case 13:
 		double_norm_test	("double.wav") ;
+				break ;
+		}
 		test_count ++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "peak") == 0)
-	{	calc_peak_test (SF_ENDIAN_BIG		| SF_FORMAT_RAW, "be-peak.raw", 1) ;
+	{	switch (index) {
+			case 14:
+		calc_peak_test (SF_ENDIAN_BIG		| SF_FORMAT_RAW, "be-peak.raw", 1) ;
+				break ;
+			case 15:
 		calc_peak_test (SF_ENDIAN_LITTLE	| SF_FORMAT_RAW, "le-peak.raw", 1) ;
+				break ;
+			case 16:
 		calc_peak_test (SF_ENDIAN_BIG		| SF_FORMAT_RAW, "be-peak.raw", 7) ;
+				break ;
+			case 17:
 		calc_peak_test (SF_ENDIAN_LITTLE	| SF_FORMAT_RAW, "le-peak.raw", 7) ;
+				break ;
+		}
 		test_count ++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "format"))
-	{	format_tests () ;
+	{	switch (index) {
+			case 18:
+		format_tests () ;
+				break ;
+		}
 		test_count ++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "trunc") == 0)
-	{	truncate_test ("truncate.raw", SF_FORMAT_RAW | SF_FORMAT_PCM_32) ;
+	{	switch (index) {
+			case 19:
+		truncate_test ("truncate.raw", SF_FORMAT_RAW | SF_FORMAT_PCM_32) ;
+				break ;
+			case 20:
 		truncate_test ("truncate.au" , SF_FORMAT_AU | SF_FORMAT_PCM_16) ;
+				break ;
+		}
 		test_count ++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "inst") == 0)
-	{	instrument_test ("instrument.wav", SF_FORMAT_WAV | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 21:
+		instrument_test ("instrument.wav", SF_FORMAT_WAV | SF_FORMAT_PCM_16) ;
+				break ;
+			case 22:
 		instrument_test ("instrument.aiff" , SF_FORMAT_AIFF | SF_FORMAT_PCM_24) ;
+				break ;
+		}
 		/*-instrument_test ("instrument.xi", SF_FORMAT_XI | SF_FORMAT_DPCM_16) ;-*/
 		test_count ++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "current_sf_info") == 0)
-	{	current_sf_info_test ("current.wav") ;
+	{	switch (index) {
+			case 23:
+		current_sf_info_test ("current.wav") ;
+				break ;
+		}
 		test_count ++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "bext") == 0)
-	{	broadcast_test ("broadcast.wav", SF_FORMAT_WAV | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 24:
+		broadcast_test ("broadcast.wav", SF_FORMAT_WAV | SF_FORMAT_PCM_16) ;
+				break ;
+			case 25:
 		broadcast_rdwr_test	("broadcast.wav", SF_FORMAT_WAV | SF_FORMAT_PCM_16) ;
 
+				break ;
+			case 26:
 		broadcast_test ("broadcast.wavex", SF_FORMAT_WAVEX | SF_FORMAT_PCM_16) ;
+				break ;
+			case 27:
 		broadcast_rdwr_test	("broadcast.wavex", SF_FORMAT_WAVEX | SF_FORMAT_PCM_16) ;
 
+				break ;
+			case 28:
 		broadcast_test ("broadcast.rf64", SF_FORMAT_RF64 | SF_FORMAT_PCM_16) ;
+				break ;
+			case 29:
 		broadcast_rdwr_test	("broadcast.rf64", SF_FORMAT_RF64 | SF_FORMAT_PCM_16) ;
+				break ;
+		}
 		test_count ++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "cart") == 0)
-	{	cart_test ("cart.wav", SF_FORMAT_WAV | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 30:
+		cart_test ("cart.wav", SF_FORMAT_WAV | SF_FORMAT_PCM_16) ;
+				break ;
+			case 31:
 		cart_rdwr_test ("cart.wav", SF_FORMAT_WAV | SF_FORMAT_PCM_16) ;
+				break ;
+			case 32:
 		cart_test ("cart.rf64", SF_FORMAT_RF64 | SF_FORMAT_PCM_16) ;
+				break ;
+			case 33:
 		cart_rdwr_test ("cart.rf64", SF_FORMAT_RF64 | SF_FORMAT_PCM_16) ;
+				break ;
+		}
 		test_count ++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "bextch") == 0)
-	{	broadcast_coding_history_test ("coding_history.wav") ;
+	{	switch (index) {
+			case 34:
+		broadcast_coding_history_test ("coding_history.wav") ;
+				break ;
+			case 35:
 		broadcast_coding_history_size ("coding_hist_size.wav") ;
+				break ;
+		}
 		test_count ++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "chanmap") == 0)
-	{	channel_map_test ("chanmap.wavex", SF_FORMAT_WAVEX | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 36:
+		channel_map_test ("chanmap.wavex", SF_FORMAT_WAVEX | SF_FORMAT_PCM_16) ;
+				break ;
+			case 37:
 		channel_map_test ("chanmap.rf64", SF_FORMAT_RF64 | SF_FORMAT_PCM_16) ;
+				break ;
+			case 38:
 		channel_map_test ("chanmap.aifc" , SF_FORMAT_AIFF | SF_FORMAT_PCM_16) ;
+				break ;
+			case 39:
 		channel_map_test ("chanmap.caf" , SF_FORMAT_CAF | SF_FORMAT_PCM_16) ;
+				break ;
+		}
 		test_count ++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "rawend") == 0)
-	{	raw_needs_endswap_test ("raw_end.wav", SF_FORMAT_WAV) ;
+	{	switch (index) {
+			case 40:
+		raw_needs_endswap_test ("raw_end.wav", SF_FORMAT_WAV) ;
+				break ;
+			case 41:
 		raw_needs_endswap_test ("raw_end.wavex", SF_FORMAT_WAVEX) ;
+				break ;
+			case 42:
 		raw_needs_endswap_test ("raw_end.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV) ;
+				break ;
+			case 43:
 		raw_needs_endswap_test ("raw_end.aiff", SF_FORMAT_AIFF) ;
+				break ;
+			case 44:
 		raw_needs_endswap_test ("raw_end.aiff_le", SF_ENDIAN_LITTLE | SF_FORMAT_AIFF) ;
+				break ;
+		}
 		test_count ++ ;
 		} ;
 
diff --git a/tests/compression_size_test.c b/tests/compression_size_test.c
index ddacf949..6b706137 100644
--- a/tests/compression_size_test.c
+++ b/tests/compression_size_test.c
@@ -29,6 +29,7 @@
 
 #include	"utils.h"
 #include	"dft_cmp.h"
+#include	"defects4cpp.h"
 
 #define	SAMPLE_RATE		16000
 #define	DATA_LENGTH		(SAMPLE_RATE)
@@ -190,14 +191,23 @@ main (int argc, char *argv [])
 	if (strcmp (argv [1], "all") == 0)
 		all_tests = 1 ;
 
+	int index = defects4cpp_test_index () ;
 	if (all_tests || strcmp (argv [1], "vorbis") == 0)
-	{	vorbis_test () ;
+	{	switch (index) {
+			case 45:
+		vorbis_test () ;
 		compression_size_test (SF_FORMAT_OGG | SF_FORMAT_VORBIS, "vorbis.oga") ;
+				break ;
+		}
 		tests ++ ;
 		} ;
 
 	if (all_tests || strcmp (argv [1], "flac") == 0)
-	{	compression_size_test (SF_FORMAT_FLAC | SF_FORMAT_PCM_16, "pcm16.flac") ;
+	{	switch (index) {
+			case 46:
+		compression_size_test (SF_FORMAT_FLAC | SF_FORMAT_PCM_16, "pcm16.flac") ;
+				break ;
+		}
 		tests ++ ;
 		} ;
 
diff --git a/tests/cpp_test.cc b/tests/cpp_test.cc
index 364ec86e..d2265112 100644
--- a/tests/cpp_test.cc
+++ b/tests/cpp_test.cc
@@ -23,6 +23,7 @@
 #include <sndfile.hh>
 
 #include "utils.h"
+#include "defects4cpp.h"
 
 static short	sbuffer [100] ;
 static int 		ibuffer [100] ;
@@ -299,14 +300,28 @@ ceeplusplus_handle_test (const char *filename, int format)
 int
 main (void)
 {
+	switch (defects4cpp_test_index()) {
+		case 47:
 	ceeplusplus_test ("cpp_test.wav", SF_FORMAT_WAV | SF_FORMAT_PCM_16) ;
+			break;
+		case 48:
 	ceeplusplus_test ("cpp_test.aiff", SF_FORMAT_AIFF | SF_FORMAT_PCM_S8) ;
+			break;
+		case 49:
 	ceeplusplus_test ("cpp_test.au", SF_FORMAT_AU | SF_FORMAT_FLOAT) ;
+			break;
+		case 50:
 
 	ceeplusplus_extra_test () ;
+			break;
+		case 51:
 	ceeplusplus_handle_test ("cpp_test.wav", SF_FORMAT_WAV | SF_FORMAT_PCM_16) ;
 
+			break;
+		case 52:
 	ceeplusplus_wchar_test () ;
+			break;
+	}
 
 	return 0 ;
 } /* main */
diff --git a/tests/defects4cpp.h b/tests/defects4cpp.h
new file mode 100644
index 00000000..c5aecec3
--- /dev/null
+++ b/tests/defects4cpp.h
@@ -0,0 +1,11 @@
+#include <lua5.3/lauxlib.h>
+#include <lua5.3/lualib.h>
+
+static int defects4cpp_test_index () {
+	lua_State *L = luaL_newstate () ;
+	luaL_openlibs (L) ;
+	luaL_dofile (L, "tests/defects4cpp.lua") ;
+	int ret = lua_tonumber (L, -1) ;
+	lua_close (L) ;
+	return ret ;
+}
diff --git a/tests/defects4cpp.lua b/tests/defects4cpp.lua
new file mode 100644
index 00000000..a4325f62
--- /dev/null
+++ b/tests/defects4cpp.lua
@@ -0,0 +1 @@
+return 1
diff --git a/tests/dither_test.c b/tests/dither_test.c
index e9eef7c1..a03182d1 100644
--- a/tests/dither_test.c
+++ b/tests/dither_test.c
@@ -27,6 +27,7 @@
 #include	<sndfile.h>
 
 #include	"utils.h"
+#include	"defects4cpp.h"
 
 #define	BUFFER_LEN		(1 << 16)
 #define LOG_BUFFER_SIZE	1024
@@ -54,63 +55,111 @@ main (int argc, char *argv [])
 
 	do_all = ! strcmp (argv [1], "all") ;
 
+	int index = defects4cpp_test_index () ;
 	if (do_all || ! strcmp (argv [1], "wav"))
-	{	dither_test ("dither.wav", SF_FORMAT_WAV | SF_FORMAT_PCM_U8) ;
+	{	switch (index) {
+			case 53:
+		dither_test ("dither.wav", SF_FORMAT_WAV | SF_FORMAT_PCM_U8) ;
+				break ;
+	}
 		test_count++ ;
 		} ;
-
 	if (do_all || ! strcmp (argv [1], "aiff"))
-	{	dither_test ("dither.aiff", SF_FORMAT_AIFF | SF_FORMAT_PCM_S8) ;
+	{	switch (index) {
+			case 54:
+		dither_test ("dither.aiff", SF_FORMAT_AIFF | SF_FORMAT_PCM_S8) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "au"))
-	{	dither_test ("dither.au", SF_FORMAT_AU | SF_FORMAT_PCM_S8) ;
+	{	switch (index) {
+			case 55:
+		dither_test ("dither.au", SF_FORMAT_AU | SF_FORMAT_PCM_S8) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "svx"))
-	{	dither_test ("dither.svx", SF_FORMAT_SVX | SF_FORMAT_PCM_S8) ;
+	{	switch (index) {
+			case 56:
+		dither_test ("dither.svx", SF_FORMAT_SVX | SF_FORMAT_PCM_S8) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "nist"))
-	{	dither_test ("dither.nist", SF_FORMAT_NIST | SF_FORMAT_PCM_S8) ;
+	{	switch (index) {
+			case 57:
+		dither_test ("dither.nist", SF_FORMAT_NIST | SF_FORMAT_PCM_S8) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "paf"))
-	{	dither_test ("dither.paf", SF_FORMAT_PAF | SF_FORMAT_PCM_S8) ;
+	{	switch (index) {
+			case 58:
+		dither_test ("dither.paf", SF_FORMAT_PAF | SF_FORMAT_PCM_S8) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "ircam"))
-	{	dither_test ("dither.ircam", SF_FORMAT_IRCAM | SF_FORMAT_PCM_S8) ;
+	{	switch (index) {
+			case 59:
+		dither_test ("dither.ircam", SF_FORMAT_IRCAM | SF_FORMAT_PCM_S8) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "voc"))
-	{	dither_test ("dither.voc", SF_FORMAT_VOC | SF_FORMAT_PCM_S8) ;
+	{	switch (index) {
+			case 60:
+		dither_test ("dither.voc", SF_FORMAT_VOC | SF_FORMAT_PCM_S8) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "w64"))
-	{	dither_test ("dither.w64", SF_FORMAT_W64 | SF_FORMAT_PCM_S8) ;
+	{	switch (index) {
+			case 61:
+		dither_test ("dither.w64", SF_FORMAT_W64 | SF_FORMAT_PCM_S8) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "mat4"))
-	{	dither_test ("dither.mat4", SF_FORMAT_MAT4 | SF_FORMAT_PCM_S8) ;
+	{	switch (index) {
+			case 62:
+		dither_test ("dither.mat4", SF_FORMAT_MAT4 | SF_FORMAT_PCM_S8) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "mat5"))
-	{	dither_test ("dither.mat5", SF_FORMAT_MAT5 | SF_FORMAT_PCM_S8) ;
+	{	switch (index) {
+			case 63:
+		dither_test ("dither.mat5", SF_FORMAT_MAT5 | SF_FORMAT_PCM_S8) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "pvf"))
-	{	dither_test ("dither.pvf", SF_FORMAT_PVF | SF_FORMAT_PCM_S8) ;
+	{	switch (index) {
+			case 64:
+		dither_test ("dither.pvf", SF_FORMAT_PVF | SF_FORMAT_PCM_S8) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
diff --git a/tests/dwvw_test.c b/tests/dwvw_test.c
index 2bd11d18..b76e236b 100644
--- a/tests/dwvw_test.c
+++ b/tests/dwvw_test.c
@@ -30,6 +30,7 @@
 #include <sndfile.h>
 
 #include "utils.h"
+#include "defects4cpp.h"
 
 #define	BUFFER_SIZE		(10000)
 
@@ -42,9 +43,17 @@ static	void	dwvw_test (const char *filename, int format, int bit_width) ;
 int
 main (void)
 {
+	switch (defects4cpp_test_index ()) {
+		case 65:
 	dwvw_test ("dwvw12.raw", SF_FORMAT_RAW | SF_FORMAT_DWVW_12, 12) ;
+			break ;
+		case 66:
 	dwvw_test ("dwvw16.raw", SF_FORMAT_RAW | SF_FORMAT_DWVW_16, 16) ;
+			break ;
+		case 67:
 	dwvw_test ("dwvw24.raw", SF_FORMAT_RAW | SF_FORMAT_DWVW_24, 24) ;
+			break ;
+	}
 
 	return 0 ;
 } /* main */
diff --git a/tests/error_test.c b/tests/error_test.c
index 4207c0a3..8cc5bd2c 100644
--- a/tests/error_test.c
+++ b/tests/error_test.c
@@ -33,6 +33,7 @@
 #include <sndfile.h>
 
 #include "utils.h"
+#include "defects4cpp.h"
 
 #define	BUFFER_SIZE		(1 << 15)
 #define	SHORT_BUFFER	(256)
@@ -232,14 +233,28 @@ error_close_test (void)
 int
 main (void)
 {
+	switch (defects4cpp_test_index ()) {
+		case 68:
 	error_number_test () ;
+			break ;
+		case 69:
 	error_value_test () ;
 
+			break ;
+		case 70:
 	error_close_test () ;
 
+			break ;
+		case 71:
 	no_file_test ("no_file.wav") ;
+			break ;
+		case 72:
 	zero_length_test ("zero_length.wav") ;
+			break ;
+		case 73:
 	bad_wav_test ("bad_wav.wav") ;
+			break ;
+	}
 
 	return 0 ;
 } /* main */
diff --git a/tests/external_libs_test.c b/tests/external_libs_test.c
index 86b02907..0770674c 100644
--- a/tests/external_libs_test.c
+++ b/tests/external_libs_test.c
@@ -26,6 +26,7 @@
 #include <sndfile.h>
 
 #include "utils.h"
+#include "defects4cpp.h"
 
 static void major_format_test (void) ;
 static void subtype_format_test (void) ;
@@ -34,9 +35,17 @@ static void simple_format_test (void) ;
 int
 main (void)
 {
+	switch (defects4cpp_test_index ()) {
+		case 74:
 	major_format_test () ;
+			break ;
+		case 75:
 	subtype_format_test () ;
+			break ;
+		case 76:
 	simple_format_test () ;
+			break ;
+	}
 
 	return 0 ;
 } /* main */
diff --git a/tests/fix_this.c b/tests/fix_this.c
index 8ec06c6b..9bfc8b36 100644
--- a/tests/fix_this.c
+++ b/tests/fix_this.c
@@ -26,6 +26,7 @@
 #include <sndfile.h>
 
 #include "utils.h"
+#include "defects4cpp.h"
 
 #define		BUFFER_SIZE		(1 << 14)
 #define		SAMPLE_RATE		(11025)
@@ -57,7 +58,11 @@ int
 main (void)
 {	const char	*filename = "test.au" ;
 
+	switch (defects4cpp_test_index ()) {
+		case 77:
 	lcomp_test_int	("au_g721", filename, SF_ENDIAN_BIG | SF_FORMAT_AU | SF_FORMAT_G721_32, 0.06) ;
+			break ;
+	}
 
 	return 0 ;
 } /* main */
diff --git a/tests/format_check_test.c b/tests/format_check_test.c
index a371c71f..47eec197 100644
--- a/tests/format_check_test.c
+++ b/tests/format_check_test.c
@@ -28,6 +28,7 @@
 
 #include "sndfile.h"
 #include "utils.h"
+#include "defects4cpp.h"
 
 static void format_error_test (void) ;
 static void format_combo_test (void) ;
@@ -35,8 +36,14 @@ static void format_combo_test (void) ;
 int
 main (void)
 {
+	switch (defects4cpp_test_index ()) {
+		case 78:
 	format_error_test () ;
+			break ;
+		case 79:
 	format_combo_test () ;
+			break ;
+	}
 
 	return 0 ;
 } /* main */
diff --git a/tests/headerless_test.c b/tests/headerless_test.c
index 6d3e2f25..486afc6d 100644
--- a/tests/headerless_test.c
+++ b/tests/headerless_test.c
@@ -31,6 +31,7 @@
 #include <sndfile.h>
 
 #include "utils.h"
+#include "defects4cpp.h"
 
 #define	BUFFER_SIZE		(2000)
 
@@ -40,13 +41,25 @@ static void headerless_test (const char * filename, int format, int expected) ;
 int
 main (void)
 {
+	switch (defects4cpp_test_index ()) {
+		case 80:
 	old_test () ;
 
+			break ;
+		case 81:
 	headerless_test ("raw.vox", SF_FORMAT_VOX_ADPCM, SF_FORMAT_RAW | SF_FORMAT_VOX_ADPCM) ;
+			break ;
+		case 82:
 	headerless_test ("raw.gsm", SF_FORMAT_GSM610, SF_FORMAT_RAW | SF_FORMAT_GSM610) ;
+			break ;
+		case 83:
 
 	headerless_test ("raw.snd", SF_FORMAT_ULAW, SF_FORMAT_RAW | SF_FORMAT_ULAW) ;
+			break ;
+		case 84:
 	headerless_test ("raw.au" , SF_FORMAT_ULAW, SF_FORMAT_RAW | SF_FORMAT_ULAW) ;
+			break ;
+	}
 
 	return 0 ;
 } /* main */
diff --git a/tests/largefile_test.c b/tests/largefile_test.c
index 328a589a..17a12370 100644
--- a/tests/largefile_test.c
+++ b/tests/largefile_test.c
@@ -29,6 +29,7 @@
 #include <sndfile.h>
 
 #include "utils.h"
+#include "defects4cpp.h"
 
 #define	BUFFER_LEN		(1024 * 1024)
 #define	BUFFER_COUNT	(768)
@@ -38,8 +39,14 @@ static void largefile_test (int filetype, const char * filename) ;
 int
 main (void)
 {
+	switch (defects4cpp_test_index ()) {
+		case 85:
 	largefile_test (SF_FORMAT_WAV, "largefile.wav") ;
+			break ;
+		case 86:
 	largefile_test (SF_FORMAT_AIFF, "largefile.aiff") ;
+			break ;
+	}
 
 	return 0 ;
 } /* main */
diff --git a/tests/locale_test.c b/tests/locale_test.c
index b67d549c..5fcaa777 100644
--- a/tests/locale_test.c
+++ b/tests/locale_test.c
@@ -37,6 +37,7 @@
 
 #include "sndfile.h"
 #include "utils.h"
+#include "defects4cpp.h"
 
 static void utf8_test (void) ;
 static void wchar_test (void) ;
@@ -44,8 +45,14 @@ static void wchar_test (void) ;
 int
 main (void)
 {
+	switch (defects4cpp_test_index ()) {
+		case 87:
 	utf8_test () ;
+			break ;
+		case 88:
 	wchar_test () ;
+			break ;
+	}
 
 	return 0 ;
 } /* main */
diff --git a/tests/lossy_comp_test.c b/tests/lossy_comp_test.c
index c0723737..b9b6c3a1 100644
--- a/tests/lossy_comp_test.c
+++ b/tests/lossy_comp_test.c
@@ -32,6 +32,7 @@
 #include <sndfile.h>
 
 #include "utils.h"
+#include "defects4cpp.h"
 
 #define	BUFFER_SIZE		(1 << 14)
 #define	SAMPLE_RATE		11025
@@ -111,186 +112,382 @@ main (int argc, char *argv [])
 
 	do_all = ! strcmp (argv [1], "all") ;
 
+	int index = defects4cpp_test_index () ;
+
 	if (do_all || strcmp (argv [1], "wav_pcm") == 0)
 	{	/* This is just a sanity test for PCM encoding. */
+		switch (index) {
+			case 89:
 		lcomp_test_short	("pcm.wav", SF_FORMAT_WAV | SF_FORMAT_PCM_16, 2, 1e-50) ;
+				break ;
+			case 90:
 		lcomp_test_int		("pcm.wav", SF_FORMAT_WAV | SF_FORMAT_PCM_32, 2, 1e-50) ;
+				break ;
+			case 91:
 		lcomp_test_short	("pcm.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV | SF_FORMAT_PCM_16, 2, 1e-50) ;
+				break ;
+			case 92:
 		lcomp_test_int		("pcm.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV | SF_FORMAT_PCM_32, 2, 1e-50) ;
+				break ;
+			case 93:
 		/* Lite remove start */
 		lcomp_test_float	("pcm.wav", SF_FORMAT_WAV | SF_FORMAT_FLOAT, 2, 1e-50) ;
+				break ;
+			case 94:
 		lcomp_test_double	("pcm.wav", SF_FORMAT_WAV | SF_FORMAT_DOUBLE, 2, 1e-50) ;
+				break ;
+			case 95:
 		/* Lite remove end */
 
 		read_raw_test ("pcm.wav", SF_FORMAT_WAV | SF_FORMAT_PCM_U8, 2) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	/* For all the rest, if the file format supports more than 1 channel, use stereo. */
 	/* Lite remove start */
 	if (do_all || strcmp (argv [1], "wav_ima") == 0)
-	{	lcomp_test_short	("ima.wav", SF_FORMAT_WAV | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
+	{	switch (index) {
+			case 96:
+		lcomp_test_short	("ima.wav", SF_FORMAT_WAV | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
+				break ;
+			case 97:
 		lcomp_test_int		("ima.wav", SF_FORMAT_WAV | SF_FORMAT_IMA_ADPCM, 2, 0.65) ;
+				break ;
+			case 98:
 		lcomp_test_float	("ima.wav", SF_FORMAT_WAV | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
+				break ;
+			case 99:
 		lcomp_test_double	("ima.wav", SF_FORMAT_WAV | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
 
+				break ;
+			case 100:
 		lcomp_test_short	("ima.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
+				break ;
+			case 101:
 		lcomp_test_int		("ima.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
+				break ;
+			case 102:
 		lcomp_test_float	("ima.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
+				break ;
+			case 103:
 		lcomp_test_double	("ima.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
 
+				break ;
+			case 104:
 		sdlcomp_test_short	("ima.wav", SF_FORMAT_WAV | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
+				break ;
+			case 105:
 		sdlcomp_test_int	("ima.wav", SF_FORMAT_WAV | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
+				break ;
+			case 106:
 		sdlcomp_test_float	("ima.wav", SF_FORMAT_WAV | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
+				break ;
+			case 107:
 		sdlcomp_test_double	("ima.wav", SF_FORMAT_WAV | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "wav_msadpcm") == 0)
-	{	lcomp_test_short	("msadpcm.wav", SF_FORMAT_WAV | SF_FORMAT_MS_ADPCM, 2, 0.36) ;
+	{	switch (index) {
+			case 108:
+		lcomp_test_short	("msadpcm.wav", SF_FORMAT_WAV | SF_FORMAT_MS_ADPCM, 2, 0.36) ;
+				break ;
+			case 109:
 		lcomp_test_int		("msadpcm.wav", SF_FORMAT_WAV | SF_FORMAT_MS_ADPCM, 2, 0.36) ;
+				break ;
+			case 110:
 		lcomp_test_float	("msadpcm.wav", SF_FORMAT_WAV | SF_FORMAT_MS_ADPCM, 2, 0.36) ;
+				break ;
+			case 111:
 		lcomp_test_double	("msadpcm.wav", SF_FORMAT_WAV | SF_FORMAT_MS_ADPCM, 2, 0.36) ;
 
+				break ;
+			case 112:
 		lcomp_test_short	("msadpcm.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV | SF_FORMAT_MS_ADPCM, 2, 0.36) ;
+				break ;
+			case 113:
 		lcomp_test_int		("msadpcm.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV | SF_FORMAT_MS_ADPCM, 2, 0.36) ;
+				break ;
+			case 114:
 		lcomp_test_float	("msadpcm.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV | SF_FORMAT_MS_ADPCM, 2, 0.36) ;
+				break ;
+			case 115:
 		lcomp_test_double	("msadpcm.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV | SF_FORMAT_MS_ADPCM, 2, 0.36) ;
 
+				break ;
+			case 116:
 		sdlcomp_test_short	("msadpcm.wav", SF_FORMAT_WAV | SF_FORMAT_MS_ADPCM, 2, 0.36) ;
+				break ;
+			case 117:
 		sdlcomp_test_int	("msadpcm.wav", SF_FORMAT_WAV | SF_FORMAT_MS_ADPCM, 2, 0.36) ;
+				break ;
+			case 118:
 		sdlcomp_test_float	("msadpcm.wav", SF_FORMAT_WAV | SF_FORMAT_MS_ADPCM, 2, 0.36) ;
+				break ;
+			case 119:
 		sdlcomp_test_double	("msadpcm.wav", SF_FORMAT_WAV | SF_FORMAT_MS_ADPCM, 2, 0.36) ;
+				break ;
+		}
 
 		test_count++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "wav_g721") == 0)
 	{	printf ("**** Fix this later : error bound should be 0.06 ****\n") ;
+		switch (index) {
+			case 120:
 		lcomp_test_short	("g721.wav", SF_FORMAT_WAV | SF_FORMAT_G721_32, 1, 0.7) ;
+				break ;
+			case 121:
 		lcomp_test_int		("g721.wav", SF_FORMAT_WAV | SF_FORMAT_G721_32, 1, 0.7) ;
 
+				break ;
+			case 122:
 		lcomp_test_short	("g721.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV | SF_FORMAT_G721_32, 1, 0.7) ;
+				break ;
+			case 123:
 		lcomp_test_int		("g721.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV | SF_FORMAT_G721_32, 1, 0.7) ;
+				break ;
+		}
 
 		test_count++ ;
 		} ;
 	/* Lite remove end */
 
 	if (do_all || strcmp (argv [1], "wav_ulaw") == 0)
-	{	lcomp_test_short	("ulaw.wav", SF_FORMAT_WAV | SF_FORMAT_ULAW, 2, 0.04) ;
+	{	switch (index) {
+			case 124:
+		lcomp_test_short	("ulaw.wav", SF_FORMAT_WAV | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 125:
 		lcomp_test_int		("ulaw.wav", SF_FORMAT_WAV | SF_FORMAT_ULAW, 2, 0.04) ;
 
+				break ;
+			case 126:
 		lcomp_test_short	("ulaw.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 127:
 		lcomp_test_int		("ulaw.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV | SF_FORMAT_ULAW, 2, 0.04) ;
 
+				break ;
+			case 128:
 		/* Lite remove start */
 		lcomp_test_float	("ulaw.wav", SF_FORMAT_WAV | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 129:
 		lcomp_test_double	("ulaw.wav", SF_FORMAT_WAV | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 130:
 		/* Lite remove end */
 
 		read_raw_test ("ulaw.wav", SF_FORMAT_WAV | SF_FORMAT_ULAW, 2) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "wav_alaw") == 0)
-	{	lcomp_test_short	("alaw.wav", SF_FORMAT_WAV | SF_FORMAT_ALAW, 2, 0.04) ;
+	{	switch (index) {
+			case 131:
+		lcomp_test_short	("alaw.wav", SF_FORMAT_WAV | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 132:
 		lcomp_test_int		("alaw.wav", SF_FORMAT_WAV | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 133:
 		/* Lite remove start */
 		lcomp_test_float	("alaw.wav", SF_FORMAT_WAV | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 134:
 		lcomp_test_double	("alaw.wav", SF_FORMAT_WAV | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 135:
 		/* Lite remove end */
 
 		read_raw_test ("alaw.wav", SF_FORMAT_WAV | SF_FORMAT_ALAW, 2) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "wav_gsm610") == 0)
 	{	/* Don't do lcomp_test_XXX as the errors are too big. */
+		switch (index) {
+			case 136:
 		sdlcomp_test_short	("gsm610.wav", SF_FORMAT_WAV | SF_FORMAT_GSM610, 1, 0.24) ;
+				break ;
+			case 137:
 		sdlcomp_test_int	("gsm610.wav", SF_FORMAT_WAV | SF_FORMAT_GSM610, 1, 0.24) ;
 
+				break ;
+			case 138:
 		sdlcomp_test_short	("gsm610.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV | SF_FORMAT_GSM610, 1, 0.24) ;
+				break ;
+			case 139:
 		sdlcomp_test_int	("gsm610.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV | SF_FORMAT_GSM610, 1, 0.24) ;
 
+				break ;
+			case 140:
 		/* Lite remove start */
 		sdlcomp_test_float	("gsm610.wav", SF_FORMAT_WAV | SF_FORMAT_GSM610, 1, 0.24) ;
+				break ;
+			case 141:
 		sdlcomp_test_double	("gsm610.wav", SF_FORMAT_WAV | SF_FORMAT_GSM610, 1, 0.24) ;
 		/* Lite remove end */
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "aiff_ulaw") == 0)
-	{	lcomp_test_short	("ulaw.aiff", SF_FORMAT_AIFF | SF_FORMAT_ULAW, 2, 0.04) ;
+	{	switch (index) {
+			case 142:
+		lcomp_test_short	("ulaw.aiff", SF_FORMAT_AIFF | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 143:
 		lcomp_test_int		("ulaw.aiff", SF_FORMAT_AIFF | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 144:
 		/* Lite remove start */
 		lcomp_test_float	("ulaw.aiff", SF_FORMAT_AIFF | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 145:
 		lcomp_test_double	("ulaw.aiff", SF_FORMAT_AIFF | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 146:
 		/* Lite remove end */
 
 		read_raw_test ("ulaw.aiff", SF_FORMAT_AIFF | SF_FORMAT_ULAW, 2) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "aiff_alaw") == 0)
-	{	lcomp_test_short	("alaw.aiff", SF_FORMAT_AIFF | SF_FORMAT_ALAW, 2, 0.04) ;
+	{	switch (index) {
+			case 147:
+		lcomp_test_short	("alaw.aiff", SF_FORMAT_AIFF | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 148:
 		lcomp_test_int		("alaw.aiff", SF_FORMAT_AIFF | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 149:
 		/* Lite remove start */
 		lcomp_test_float	("alaw.aiff", SF_FORMAT_AIFF | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 150:
 		lcomp_test_double	("alaw.aiff", SF_FORMAT_AIFF | SF_FORMAT_ALAW, 2, 0.04) ;
 		/* Lite remove end */
+				break ;
+			case 151:
 
 		read_raw_test ("alaw.aiff", SF_FORMAT_AIFF | SF_FORMAT_ALAW, 2) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "aiff_gsm610") == 0)
 	{	/* Don't do lcomp_test_XXX as the errors are too big. */
+		switch (index) {
+			case 152:
 		sdlcomp_test_short	("gsm610.aiff", SF_FORMAT_AIFF | SF_FORMAT_GSM610, 1, 0.24) ;
+				break ;
+			case 153:
 		sdlcomp_test_int	("gsm610.aiff", SF_FORMAT_AIFF | SF_FORMAT_GSM610, 1, 0.24) ;
+				break ;
+			case 154:
 		/* Lite remove start */
 		sdlcomp_test_float	("gsm610.aiff", SF_FORMAT_AIFF | SF_FORMAT_GSM610, 1, 0.24) ;
+				break ;
+			case 155:
 		sdlcomp_test_double	("gsm610.aiff", SF_FORMAT_AIFF | SF_FORMAT_GSM610, 1, 0.24) ;
 		/* Lite remove end */
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (strcmp (argv [1], "aiff_ima") == 0)
-	{	lcomp_test_short	("ima.aiff", SF_FORMAT_AIFF | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
+	{	switch (index) {
+			case 156:
+		lcomp_test_short ("ima.aiff", SF_FORMAT_AIFF | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
+				break ;
+			case 157:
 		lcomp_test_int		("ima.aiff", SF_FORMAT_AIFF | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
+				break ;
+			case 158:
 		/* Lite remove start */
 		lcomp_test_float	("ima.aiff", SF_FORMAT_AIFF | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
+				break ;
+			case 159:
 		lcomp_test_double	("ima.aiff", SF_FORMAT_AIFF | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
 		/* Lite remove end */
+				break ;
+		}
 		} ;
 
 	if (do_all || strcmp (argv [1], "au_ulaw") == 0)
-	{	lcomp_test_short	("ulaw.au", SF_ENDIAN_BIG		| SF_FORMAT_AU | SF_FORMAT_ULAW, 2, 0.04) ;
+	{	switch (index) {
+			case 160:
+		lcomp_test_short ("ulaw.au", SF_ENDIAN_BIG | SF_FORMAT_AU | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 161:
 		lcomp_test_int		("ulaw.au", SF_ENDIAN_LITTLE	| SF_FORMAT_AU | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 162:
 		/* Lite remove start */
 		lcomp_test_float	("ulaw.au", SF_ENDIAN_LITTLE	| SF_FORMAT_AU | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 163:
 		lcomp_test_double	("ulaw.au", SF_ENDIAN_BIG		| SF_FORMAT_AU | SF_FORMAT_ULAW, 2, 0.04) ;
 		/* Lite remove end */
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "au_alaw") == 0)
-	{	lcomp_test_short	("alaw.au", SF_ENDIAN_LITTLE	| SF_FORMAT_AU | SF_FORMAT_ALAW, 2, 0.04) ;
+	{	switch (index) {
+			case 164:
+		lcomp_test_short ("alaw.au", SF_ENDIAN_LITTLE | SF_FORMAT_AU | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 165:
 		lcomp_test_int		("alaw.au", SF_ENDIAN_BIG		| SF_FORMAT_AU | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 166:
 		/* Lite remove start */
 		lcomp_test_float	("alaw.au", SF_ENDIAN_BIG		| SF_FORMAT_AU | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 167:
 		lcomp_test_double	("alaw.au", SF_ENDIAN_LITTLE	| SF_FORMAT_AU | SF_FORMAT_ALAW, 2, 0.04) ;
 		/* Lite remove end */
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	/* Lite remove start */
 	if (do_all || strcmp (argv [1], "au_g721") == 0)
 	{	printf ("**** Fix this later : error bound should be 0.06 ****\n") ;
+		switch (index) {
+			case 168:
 		lcomp_test_short	("g721.au", SF_ENDIAN_LITTLE	| SF_FORMAT_AU | SF_FORMAT_G721_32, 1, 0.7) ;
+				break ;
+			case 169:
 		lcomp_test_int		("g721.au", SF_ENDIAN_BIG		| SF_FORMAT_AU | SF_FORMAT_G721_32, 1, 0.7) ;
+				break ;
+			case 170:
 		lcomp_test_float	("g721.au", SF_ENDIAN_LITTLE 	| SF_FORMAT_AU | SF_FORMAT_G721_32, 1, 0.7) ;
+				break ;
+			case 171:
 		lcomp_test_double	("g721.au", SF_ENDIAN_BIG		| SF_FORMAT_AU | SF_FORMAT_G721_32, 1, 0.7) ;
+				break ;
+		}
 
 /*-		sdlcomp_test_short	("g721.au", SF_ENDIAN_BIG    | SF_FORMAT_AU | SF_FORMAT_G721_32, 1, 0.07) ;
 		sdlcomp_test_int	("g721.au", SF_ENDIAN_LITTLE | SF_FORMAT_AU | SF_FORMAT_G721_32, 1, 0.07) ;
@@ -302,15 +499,33 @@ main (int argc, char *argv [])
 
 	if (do_all || strcmp (argv [1], "au_g723") == 0)
 	{	printf ("**** Fix this later : error bound should be 0.16 ****\n") ;
+		switch (index) {
+			case 172:
 		lcomp_test_short	("g723_24.au", SF_ENDIAN_LITTLE	| SF_FORMAT_AU | SF_FORMAT_G723_24, 1, 0.7) ;
+				break ;
+			case 173:
 		lcomp_test_int		("g723_24.au", SF_ENDIAN_BIG	| SF_FORMAT_AU | SF_FORMAT_G723_24, 1, 0.7) ;
+				break ;
+			case 174:
 		lcomp_test_float	("g723_24.au", SF_ENDIAN_LITTLE | SF_FORMAT_AU | SF_FORMAT_G723_24, 1, 0.7) ;
+				break ;
+			case 175:
 		lcomp_test_double	("g723_24.au", SF_ENDIAN_BIG	| SF_FORMAT_AU | SF_FORMAT_G723_24, 1, 0.7) ;
+				break ;
+			case 176:
 
 		lcomp_test_short	("g723_40.au", SF_ENDIAN_LITTLE | SF_FORMAT_AU | SF_FORMAT_G723_40, 1, 0.85) ;
+				break ;
+			case 177:
 		lcomp_test_int		("g723_40.au", SF_ENDIAN_BIG	| SF_FORMAT_AU | SF_FORMAT_G723_40, 1, 0.84) ;
+				break ;
+			case 178:
 		lcomp_test_float	("g723_40.au", SF_ENDIAN_LITTLE | SF_FORMAT_AU | SF_FORMAT_G723_40, 1, 0.86) ;
+				break ;
+			case 179:
 		lcomp_test_double	("g723_40.au", SF_ENDIAN_BIG	| SF_FORMAT_AU | SF_FORMAT_G723_40, 1, 0.86) ;
+				break ;
+		}
 
 /*-		sdlcomp_test_short	("g723.au", SF_ENDIAN_BIG    | SF_FORMAT_AU | SF_FORMAT_G723_24, 1, 0.15) ;
 		sdlcomp_test_int	("g723.au", SF_ENDIAN_LITTLE | SF_FORMAT_AU | SF_FORMAT_G723_24, 1, 0.15) ;
@@ -322,61 +537,117 @@ main (int argc, char *argv [])
 	/* Lite remove end */
 
 	if (do_all || strcmp (argv [1], "caf_ulaw") == 0)
-	{	lcomp_test_short	("ulaw.caf", SF_FORMAT_CAF | SF_FORMAT_ULAW, 2, 0.04) ;
+	{	switch (index) {
+			case 180:
+		lcomp_test_short ("ulaw.caf", SF_FORMAT_CAF | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 181:
 		lcomp_test_int		("ulaw.caf", SF_FORMAT_CAF | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 182:
 		/* Lite remove start */
 		lcomp_test_float	("ulaw.caf", SF_FORMAT_CAF | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 183:
 		lcomp_test_double	("ulaw.caf", SF_FORMAT_CAF | SF_FORMAT_ULAW, 2, 0.04) ;
 		/* Lite remove end */
+				break ;
+			case 184:
 
 		read_raw_test ("ulaw.caf", SF_FORMAT_CAF | SF_FORMAT_ULAW, 2) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "caf_alaw") == 0)
-	{	lcomp_test_short	("alaw.caf", SF_FORMAT_CAF | SF_FORMAT_ALAW, 2, 0.04) ;
+	{	switch (index) {
+			case 185:
+		lcomp_test_short ("alaw.caf", SF_FORMAT_CAF | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 186:
 		lcomp_test_int		("alaw.caf", SF_FORMAT_CAF | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 187:
 		/* Lite remove start */
 		lcomp_test_float	("alaw.caf", SF_FORMAT_CAF | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 188:
 		lcomp_test_double	("alaw.caf", SF_FORMAT_CAF | SF_FORMAT_ALAW, 2, 0.04) ;
 		/* Lite remove end */
+				break ;
+			case 189:
 
 		read_raw_test ("alaw.caf", SF_FORMAT_CAF | SF_FORMAT_ALAW, 2) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 
 	if (do_all || strcmp (argv [1], "raw_ulaw") == 0)
-	{	lcomp_test_short	("ulaw.raw", SF_ENDIAN_LITTLE	| SF_FORMAT_RAW | SF_FORMAT_ULAW, 2, 0.04) ;
+	{	switch (index) {
+			case 190:
+		lcomp_test_short ("ulaw.raw", SF_ENDIAN_LITTLE | SF_FORMAT_RAW | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 191:
 		lcomp_test_int		("ulaw.raw", SF_ENDIAN_BIG		| SF_FORMAT_RAW | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 192:
 		/* Lite remove start */
 		lcomp_test_float	("ulaw.raw", SF_ENDIAN_LITTLE	| SF_FORMAT_RAW | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 193:
 		lcomp_test_double	("ulaw.raw", SF_ENDIAN_BIG		| SF_FORMAT_RAW | SF_FORMAT_ULAW, 2, 0.04) ;
 		/* Lite remove end */
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "raw_alaw") == 0)
-	{	lcomp_test_short	("alaw.raw", SF_ENDIAN_LITTLE	| SF_FORMAT_RAW | SF_FORMAT_ALAW, 2, 0.04) ;
+	{	switch (index) {
+			case 194:
+		lcomp_test_short	("alaw.raw", SF_ENDIAN_LITTLE	| SF_FORMAT_RAW | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 195:
 		lcomp_test_int		("alaw.raw", SF_ENDIAN_BIG		| SF_FORMAT_RAW | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 196:
 		/* Lite remove start */
 		lcomp_test_float	("alaw.raw", SF_ENDIAN_LITTLE	| SF_FORMAT_RAW | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 197:
 		lcomp_test_double	("alaw.raw", SF_ENDIAN_BIG		| SF_FORMAT_RAW | SF_FORMAT_ALAW, 2, 0.04) ;
 		/* Lite remove end */
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "raw_gsm610") == 0)
 	{	/* Don't do lcomp_test_XXX as the errors are too big. */
+		switch (index) {
+			case 198:
 		sdlcomp_test_short	("raw.gsm", SF_FORMAT_RAW | SF_FORMAT_GSM610, 1, 0.24) ;
+				break ;
+			case 199:
 		sdlcomp_test_int	("raw.gsm", SF_FORMAT_RAW | SF_FORMAT_GSM610, 1, 0.24) ;
+				break ;
+			case 200:
 		sdlcomp_test_float	("raw.gsm", SF_FORMAT_RAW | SF_FORMAT_GSM610, 1, 0.24) ;
+				break ;
+			case 201:
 		sdlcomp_test_double	("raw.gsm", SF_FORMAT_RAW | SF_FORMAT_GSM610, 1, 0.24) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "ogg_vorbis") == 0)
-	{	if (HAVE_EXTERNAL_LIBS)
+	{	switch (index) {
+			case 202:
+		if (HAVE_EXTERNAL_LIBS)
 		{	/* Don't do lcomp_test_XXX as the errors are too big. */
 			sdlcomp_test_short	("vorbis.oga", SF_FORMAT_OGG | SF_FORMAT_VORBIS, 1, 0.30) ;
 			sdlcomp_test_int	("vorbis.oga", SF_FORMAT_OGG | SF_FORMAT_VORBIS, 1, 0.30) ;
@@ -386,117 +657,249 @@ main (int argc, char *argv [])
 		else
 			puts ("    No Ogg/Vorbis tests because Ogg/Vorbis support was not compiled in.") ;
 
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	/* Lite remove start */
 	if (do_all || strcmp (argv [1], "ircam_ulaw") == 0)
-	{	lcomp_test_short	("ulaw.ircam", SF_ENDIAN_LITTLE | SF_FORMAT_IRCAM | SF_FORMAT_ULAW, 2, 0.04) ;
+	{	switch (index) {
+			case 203:
+		lcomp_test_short	("ulaw.ircam", SF_ENDIAN_LITTLE | SF_FORMAT_IRCAM | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 204:
 		lcomp_test_int		("ulaw.ircam", SF_ENDIAN_BIG	| SF_FORMAT_IRCAM | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 205:
 		lcomp_test_float	("ulaw.ircam", SF_ENDIAN_LITTLE | SF_FORMAT_IRCAM | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 206:
 		lcomp_test_double	("ulaw.ircam", SF_ENDIAN_BIG	| SF_FORMAT_IRCAM | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "ircam_alaw") == 0)
-	{	lcomp_test_short	("alaw.ircam", SF_ENDIAN_LITTLE | SF_FORMAT_IRCAM | SF_FORMAT_ALAW, 2, 0.04) ;
+	{	switch (index) {
+			case 207:
+		lcomp_test_short	("alaw.ircam", SF_ENDIAN_LITTLE | SF_FORMAT_IRCAM | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 208:
 		lcomp_test_int		("alaw.ircam", SF_ENDIAN_BIG	| SF_FORMAT_IRCAM | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 209:
 		lcomp_test_float	("alaw.ircam", SF_ENDIAN_LITTLE | SF_FORMAT_IRCAM | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 210:
 		lcomp_test_double	("alaw.ircam", SF_ENDIAN_BIG	| SF_FORMAT_IRCAM | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "nist_ulaw") == 0)
-	{	lcomp_test_short	("ulaw.nist", SF_ENDIAN_LITTLE	| SF_FORMAT_NIST | SF_FORMAT_ULAW, 2, 0.04) ;
+	{	switch (index) {
+			case 211:
+		lcomp_test_short	("ulaw.nist", SF_ENDIAN_LITTLE	| SF_FORMAT_NIST | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 212:
 		lcomp_test_int		("ulaw.nist", SF_ENDIAN_BIG		| SF_FORMAT_NIST | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 213:
 		lcomp_test_float	("ulaw.nist", SF_ENDIAN_LITTLE	| SF_FORMAT_NIST | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 214:
 		lcomp_test_double	("ulaw.nist", SF_ENDIAN_BIG		| SF_FORMAT_NIST | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "nist_alaw") == 0)
-	{	lcomp_test_short	("alaw.nist", SF_ENDIAN_LITTLE	| SF_FORMAT_NIST | SF_FORMAT_ALAW, 2, 0.04) ;
+	{	switch (index) {
+			case 215:
+		lcomp_test_short	("alaw.nist", SF_ENDIAN_LITTLE	| SF_FORMAT_NIST | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 216:
 		lcomp_test_int		("alaw.nist", SF_ENDIAN_BIG		| SF_FORMAT_NIST | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 217:
 		lcomp_test_float	("alaw.nist", SF_ENDIAN_LITTLE	| SF_FORMAT_NIST | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 218:
 		lcomp_test_double	("alaw.nist", SF_ENDIAN_BIG		| SF_FORMAT_NIST | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "voc_ulaw") == 0)
-	{	lcomp_test_short	("ulaw.voc", SF_FORMAT_VOC | SF_FORMAT_ULAW, 2, 0.04) ;
+	{	switch (index) {
+			case 219:
+		lcomp_test_short	("ulaw.voc", SF_FORMAT_VOC | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 220:
 		lcomp_test_int		("ulaw.voc", SF_FORMAT_VOC | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 221:
 		lcomp_test_float	("ulaw.voc", SF_FORMAT_VOC | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 222:
 		lcomp_test_double	("ulaw.voc", SF_FORMAT_VOC | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "voc_alaw") == 0)
-	{	lcomp_test_short	("alaw.voc", SF_FORMAT_VOC | SF_FORMAT_ALAW, 2, 0.04) ;
+	{	switch (index) {
+			case 223:
+		lcomp_test_short	("alaw.voc", SF_FORMAT_VOC | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 224:
 		lcomp_test_int		("alaw.voc", SF_FORMAT_VOC | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 225:
 		lcomp_test_float	("alaw.voc", SF_FORMAT_VOC | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 226:
 		lcomp_test_double	("alaw.voc", SF_FORMAT_VOC | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 	/* Lite remove end */
 
 	if (do_all || strcmp (argv [1], "w64_ulaw") == 0)
-	{	lcomp_test_short	("ulaw.w64", SF_FORMAT_W64 | SF_FORMAT_ULAW, 2, 0.04) ;
+	{	switch (index) {
+			case 227:
+		lcomp_test_short	("ulaw.w64", SF_FORMAT_W64 | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 228:
 		lcomp_test_int		("ulaw.w64", SF_FORMAT_W64 | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 229:
 		/* Lite remove start */
 		lcomp_test_float	("ulaw.w64", SF_FORMAT_W64 | SF_FORMAT_ULAW, 2, 0.04) ;
+				break ;
+			case 230:
 		lcomp_test_double	("ulaw.w64", SF_FORMAT_W64 | SF_FORMAT_ULAW, 2, 0.04) ;
 		/* Lite remove end */
 
+				break ;
+			case 231:
 		read_raw_test ("ulaw.w64", SF_FORMAT_W64 | SF_FORMAT_ULAW, 2) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "w64_alaw") == 0)
-	{	lcomp_test_short	("alaw.w64", SF_FORMAT_W64 | SF_FORMAT_ALAW, 2, 0.04) ;
+	{	switch (index) {
+			case 232:
+		lcomp_test_short	("alaw.w64", SF_FORMAT_W64 | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 233:
 		lcomp_test_int		("alaw.w64", SF_FORMAT_W64 | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 234:
 		/* Lite remove start */
 		lcomp_test_float	("alaw.w64", SF_FORMAT_W64 | SF_FORMAT_ALAW, 2, 0.04) ;
+				break ;
+			case 235:
 		lcomp_test_double	("alaw.w64", SF_FORMAT_W64 | SF_FORMAT_ALAW, 2, 0.04) ;
 		/* Lite remove end */
+				break ;
+			case 236:
 
 		read_raw_test ("alaw.w64", SF_FORMAT_W64 | SF_FORMAT_ALAW, 2) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	/* Lite remove start */
 	if (do_all || strcmp (argv [1], "w64_ima") == 0)
-	{	lcomp_test_short	("ima.w64", SF_FORMAT_W64 | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
+	{	switch (index) {
+			case 237:
+		lcomp_test_short	("ima.w64", SF_FORMAT_W64 | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
+				break ;
+			case 238:
 		lcomp_test_int		("ima.w64", SF_FORMAT_W64 | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
+				break ;
+			case 239:
 		lcomp_test_float	("ima.w64", SF_FORMAT_W64 | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
+				break ;
+			case 240:
 		lcomp_test_double	("ima.w64", SF_FORMAT_W64 | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
 
+				break ;
+			case 241:
 		sdlcomp_test_short	("ima.w64", SF_FORMAT_W64 | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
+				break ;
+			case 242:
 		sdlcomp_test_int	("ima.w64", SF_FORMAT_W64 | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
+				break ;
+			case 243:
 		sdlcomp_test_float	("ima.w64", SF_FORMAT_W64 | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
+				break ;
+			case 244:
 		sdlcomp_test_double	("ima.w64", SF_FORMAT_W64 | SF_FORMAT_IMA_ADPCM, 2, 0.18) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "w64_msadpcm") == 0)
-	{	lcomp_test_short	("msadpcm.w64", SF_FORMAT_W64 | SF_FORMAT_MS_ADPCM, 2, 0.36) ;
+	{	switch (index) {
+			case 245:
+		lcomp_test_short	("msadpcm.w64", SF_FORMAT_W64 | SF_FORMAT_MS_ADPCM, 2, 0.36) ;
+				break ;
+			case 246:
 		lcomp_test_int		("msadpcm.w64", SF_FORMAT_W64 | SF_FORMAT_MS_ADPCM, 2, 0.36) ;
+				break ;
+			case 247:
 		lcomp_test_float	("msadpcm.w64", SF_FORMAT_W64 | SF_FORMAT_MS_ADPCM, 2, 0.36) ;
+				break ;
+			case 248:
 		lcomp_test_double	("msadpcm.w64", SF_FORMAT_W64 | SF_FORMAT_MS_ADPCM, 2, 0.36) ;
 
+				break ;
+			case 249:
 		sdlcomp_test_short	("msadpcm.w64", SF_FORMAT_W64 | SF_FORMAT_MS_ADPCM, 2, 0.36) ;
+				break ;
+			case 250:
 		sdlcomp_test_int	("msadpcm.w64", SF_FORMAT_W64 | SF_FORMAT_MS_ADPCM, 2, 0.36) ;
+				break ;
+			case 251:
 		sdlcomp_test_float	("msadpcm.w64", SF_FORMAT_W64 | SF_FORMAT_MS_ADPCM, 2, 0.36) ;
+				break ;
+			case 252:
 		sdlcomp_test_double	("msadpcm.w64", SF_FORMAT_W64 | SF_FORMAT_MS_ADPCM, 2, 0.36) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "wve") == 0)
-	{	lcomp_test_short	("psion.wve", SF_FORMAT_WVE | SF_FORMAT_ALAW, 1, 0.04) ;
+	{	switch (index) {
+			case 253:
+		lcomp_test_short	("psion.wve", SF_FORMAT_WVE | SF_FORMAT_ALAW, 1, 0.04) ;
+				break ;
+			case 254:
 		lcomp_test_int		("psion.wve", SF_FORMAT_WVE | SF_FORMAT_ALAW, 1, 0.04) ;
+				break ;
+			case 255:
 		/* Lite remove start */
 		lcomp_test_float	("psion.wve", SF_FORMAT_WVE | SF_FORMAT_ALAW, 1, 0.04) ;
+				break ;
+			case 256:
 		lcomp_test_double	("psion.wve", SF_FORMAT_WVE | SF_FORMAT_ALAW, 1, 0.04) ;
 		/* Lite remove end */
+				break ;
+		}
 		test_count++ ;
 		} ;
 
@@ -504,37 +907,79 @@ main (int argc, char *argv [])
 
 	if (do_all || strcmp (argv [1], "w64_gsm610") == 0)
 	{	/* Don't do lcomp_test_XXX as the errors are too big. */
+		switch (index) {
+			case 257:
 		sdlcomp_test_short	("gsm610.w64", SF_FORMAT_W64 | SF_FORMAT_GSM610, 1, 0.2) ;
+				break ;
+			case 258:
 		sdlcomp_test_int	("gsm610.w64", SF_FORMAT_W64 | SF_FORMAT_GSM610, 1, 0.2) ;
+				break ;
+			case 259:
 		/* Lite remove start */
 		sdlcomp_test_float	("gsm610.w64", SF_FORMAT_W64 | SF_FORMAT_GSM610, 1, 0.2) ;
+				break ;
+			case 260:
 		sdlcomp_test_double	("gsm610.w64", SF_FORMAT_W64 | SF_FORMAT_GSM610, 1, 0.2) ;
 		/* Lite remove end */
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	/* Lite remove start */
 	if (do_all || strcmp (argv [1], "vox_adpcm") == 0)
-	{	lcomp_test_short	("adpcm.vox", SF_FORMAT_RAW | SF_FORMAT_VOX_ADPCM, 1, 0.17) ;
+	{	switch (index) {
+			case 261:
+		lcomp_test_short	("adpcm.vox", SF_FORMAT_RAW | SF_FORMAT_VOX_ADPCM, 1, 0.17) ;
+				break ;
+			case 262:
 		lcomp_test_int		("adpcm.vox", SF_FORMAT_RAW | SF_FORMAT_VOX_ADPCM, 1, 0.17) ;
+				break ;
+			case 263:
 		lcomp_test_float	("adpcm.vox", SF_FORMAT_RAW | SF_FORMAT_VOX_ADPCM, 1, 0.17) ;
+				break ;
+			case 264:
 		lcomp_test_double	("adpcm.vox", SF_FORMAT_RAW | SF_FORMAT_VOX_ADPCM, 1, 0.17) ;
 
+				break ;
+			case 265:
 		sdlcomp_test_short	("adpcm.vox", SF_FORMAT_RAW | SF_FORMAT_VOX_ADPCM, 1, 0.072) ;
+				break ;
+			case 266:
 		sdlcomp_test_int	("adpcm.vox", SF_FORMAT_RAW | SF_FORMAT_VOX_ADPCM, 1, 0.072) ;
+				break ;
+			case 267:
 		sdlcomp_test_float	("adpcm.vox", SF_FORMAT_RAW | SF_FORMAT_VOX_ADPCM, 1, 0.072) ;
+				break ;
+			case 268:
 		sdlcomp_test_double	("adpcm.vox", SF_FORMAT_RAW | SF_FORMAT_VOX_ADPCM, 1, 0.072) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || strcmp (argv [1], "xi_dpcm") == 0)
-	{	lcomp_test_short	("8bit.xi", SF_FORMAT_XI | SF_FORMAT_DPCM_8, 1, 0.25) ;
+	{	switch (index) {
+			case 269:
+		lcomp_test_short	("8bit.xi", SF_FORMAT_XI | SF_FORMAT_DPCM_8, 1, 0.25) ;
+				break ;
+			case 270:
 		lcomp_test_int		("8bit.xi", SF_FORMAT_XI | SF_FORMAT_DPCM_8, 1, 0.25) ;
 
+				break ;
+			case 271:
 		lcomp_test_short	("16bit.xi", SF_FORMAT_XI | SF_FORMAT_DPCM_16, 1, 0.002) ;
+				break ;
+			case 272:
 		lcomp_test_int		("16bit.xi", SF_FORMAT_XI | SF_FORMAT_DPCM_16, 1, 0.002) ;
+				break ;
+			case 273:
 		lcomp_test_float	("16bit.xi", SF_FORMAT_XI | SF_FORMAT_DPCM_16, 1, 0.002) ;
+				break ;
+			case 274:
 		lcomp_test_double	("16bit.xi", SF_FORMAT_XI | SF_FORMAT_DPCM_16, 1, 0.002) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 	/* Lite remove end */
diff --git a/tests/misc_test.c b/tests/misc_test.c
index b95e421d..626807f6 100644
--- a/tests/misc_test.c
+++ b/tests/misc_test.c
@@ -42,6 +42,7 @@
 #include	<sndfile.h>
 
 #include	"utils.h"
+#include	"defects4cpp.h"
 
 #define	BUFFER_LEN		(1 << 10)
 #define LOG_BUFFER_SIZE	1024
@@ -67,137 +68,213 @@ main (int argc, char *argv [])
 
 	do_all = ! strcmp (argv [1], "all") ;
 
+	int index = defects4cpp_test_index () ;
 	if (do_all || ! strcmp (argv [1], "wav"))
-	{	zero_data_test ("zerolen.wav", SF_FORMAT_WAV | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 275:
+		zero_data_test ("zerolen.wav", SF_FORMAT_WAV | SF_FORMAT_PCM_16) ;
 		filesystem_full_test (SF_FORMAT_WAV | SF_FORMAT_PCM_16) ;
 		permission_test ("readonly.wav", SF_FORMAT_WAV) ;
 		wavex_amb_test ("ambisonic.wav") ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "aiff"))
-	{	zero_data_test ("zerolen.aiff", SF_FORMAT_AIFF | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 276:
+		zero_data_test ("zerolen.aiff", SF_FORMAT_AIFF | SF_FORMAT_PCM_16) ;
 		filesystem_full_test (SF_FORMAT_AIFF | SF_FORMAT_PCM_16) ;
 		permission_test ("readonly.aiff", SF_FORMAT_AIFF) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "au"))
-	{	zero_data_test ("zerolen.au", SF_FORMAT_AU | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 277:
+		zero_data_test ("zerolen.au", SF_FORMAT_AU | SF_FORMAT_PCM_16) ;
 		filesystem_full_test (SF_FORMAT_AU | SF_FORMAT_PCM_16) ;
 		permission_test ("readonly.au", SF_FORMAT_AU) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "caf"))
-	{	zero_data_test ("zerolen.caf", SF_FORMAT_CAF | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 278:
+		zero_data_test ("zerolen.caf", SF_FORMAT_CAF | SF_FORMAT_PCM_16) ;
 		filesystem_full_test (SF_FORMAT_CAF | SF_FORMAT_PCM_16) ;
 		permission_test ("readonly.caf", SF_FORMAT_CAF) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "svx"))
-	{	zero_data_test ("zerolen.svx", SF_FORMAT_SVX | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 279:
+		zero_data_test ("zerolen.svx", SF_FORMAT_SVX | SF_FORMAT_PCM_16) ;
 		filesystem_full_test (SF_FORMAT_SVX | SF_FORMAT_PCM_16) ;
 		permission_test ("readonly.svx", SF_FORMAT_SVX) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "nist"))
-	{	zero_data_test ("zerolen.nist", SF_FORMAT_NIST | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 280:
+		zero_data_test ("zerolen.nist", SF_FORMAT_NIST | SF_FORMAT_PCM_16) ;
 		filesystem_full_test (SF_FORMAT_NIST | SF_FORMAT_PCM_16) ;
 		permission_test ("readonly.nist", SF_FORMAT_NIST) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "paf"))
-	{	zero_data_test ("zerolen.paf", SF_FORMAT_PAF | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 281:
+		zero_data_test ("zerolen.paf", SF_FORMAT_PAF | SF_FORMAT_PCM_16) ;
 		filesystem_full_test (SF_FORMAT_PAF | SF_FORMAT_PCM_16) ;
 		permission_test ("readonly.paf", SF_FORMAT_PAF) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "ircam"))
-	{	zero_data_test ("zerolen.ircam", SF_FORMAT_IRCAM | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 282:
+		zero_data_test ("zerolen.ircam", SF_FORMAT_IRCAM | SF_FORMAT_PCM_16) ;
 		filesystem_full_test (SF_FORMAT_IRCAM | SF_FORMAT_PCM_16) ;
 		permission_test ("readonly.ircam", SF_FORMAT_IRCAM) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "voc"))
-	{	zero_data_test ("zerolen.voc", SF_FORMAT_VOC | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 283:
+		zero_data_test ("zerolen.voc", SF_FORMAT_VOC | SF_FORMAT_PCM_16) ;
 		filesystem_full_test (SF_FORMAT_VOC | SF_FORMAT_PCM_16) ;
 		permission_test ("readonly.voc", SF_FORMAT_VOC) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "w64"))
-	{	zero_data_test ("zerolen.w64", SF_FORMAT_W64 | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 284:
+		zero_data_test ("zerolen.w64", SF_FORMAT_W64 | SF_FORMAT_PCM_16) ;
 		filesystem_full_test (SF_FORMAT_W64 | SF_FORMAT_PCM_16) ;
 		permission_test ("readonly.w64", SF_FORMAT_W64) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "rf64"))
-	{	zero_data_test ("zerolen.rf64", SF_FORMAT_W64 | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 285:
+		zero_data_test ("zerolen.rf64", SF_FORMAT_W64 | SF_FORMAT_PCM_16) ;
 		filesystem_full_test (SF_FORMAT_W64 | SF_FORMAT_PCM_16) ;
 		permission_test ("readonly.rf64", SF_FORMAT_W64) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "mat4"))
-	{	zero_data_test ("zerolen.mat4", SF_FORMAT_MAT4 | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 286:
+		zero_data_test ("zerolen.mat4", SF_FORMAT_MAT4 | SF_FORMAT_PCM_16) ;
 		filesystem_full_test (SF_FORMAT_MAT4 | SF_FORMAT_PCM_16) ;
 		permission_test ("readonly.mat4", SF_FORMAT_MAT4) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "mat5"))
-	{	zero_data_test ("zerolen.mat5", SF_FORMAT_MAT5 | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 287:
+		zero_data_test ("zerolen.mat5", SF_FORMAT_MAT5 | SF_FORMAT_PCM_16) ;
 		filesystem_full_test (SF_FORMAT_MAT5 | SF_FORMAT_PCM_16) ;
 		permission_test ("readonly.mat5", SF_FORMAT_MAT5) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "pvf"))
-	{	zero_data_test ("zerolen.pvf", SF_FORMAT_PVF | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 288:
+		zero_data_test ("zerolen.pvf", SF_FORMAT_PVF | SF_FORMAT_PCM_16) ;
 		filesystem_full_test (SF_FORMAT_PVF | SF_FORMAT_PCM_16) ;
 		permission_test ("readonly.pvf", SF_FORMAT_PVF) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "htk"))
-	{	zero_data_test ("zerolen.htk", SF_FORMAT_HTK | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 289:
+		zero_data_test ("zerolen.htk", SF_FORMAT_HTK | SF_FORMAT_PCM_16) ;
 		filesystem_full_test (SF_FORMAT_HTK | SF_FORMAT_PCM_16) ;
 		permission_test ("readonly.htk", SF_FORMAT_HTK) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "avr"))
-	{	zero_data_test ("zerolen.avr", SF_FORMAT_AVR | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 290:
+		zero_data_test ("zerolen.avr", SF_FORMAT_AVR | SF_FORMAT_PCM_16) ;
 		filesystem_full_test (SF_FORMAT_AVR | SF_FORMAT_PCM_16) ;
 		permission_test ("readonly.avr", SF_FORMAT_AVR) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "sds"))
-	{	zero_data_test ("zerolen.sds", SF_FORMAT_SDS | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 291:
+		zero_data_test ("zerolen.sds", SF_FORMAT_SDS | SF_FORMAT_PCM_16) ;
 		filesystem_full_test (SF_FORMAT_SDS | SF_FORMAT_PCM_16) ;
 		permission_test ("readonly.sds", SF_FORMAT_SDS) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "mpc2k"))
-	{	zero_data_test ("zerolen.mpc", SF_FORMAT_MPC2K | SF_FORMAT_PCM_16) ;
+	{	switch (index) {
+			case 292:
+		zero_data_test ("zerolen.mpc", SF_FORMAT_MPC2K | SF_FORMAT_PCM_16) ;
 		filesystem_full_test (SF_FORMAT_MPC2K | SF_FORMAT_PCM_16) ;
 		permission_test ("readonly.mpc", SF_FORMAT_MPC2K) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "ogg"))
-	{	zero_data_test ("zerolen.oga", SF_FORMAT_OGG | SF_FORMAT_VORBIS) ;
+	{	switch (index) {
+			case 294: zero_data_test ("zerolen.oga", SF_FORMAT_OGG | SF_FORMAT_VORBIS) ;
 		/*-filesystem_full_test (SF_FORMAT_OGG | SF_FORMAT_VORBIS) ;-*/
 		permission_test ("readonly.oga", SF_FORMAT_OGG) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
diff --git a/tests/multi_file_test.c b/tests/multi_file_test.c
index 502d15a6..7e226fa3 100644
--- a/tests/multi_file_test.c
+++ b/tests/multi_file_test.c
@@ -39,6 +39,7 @@
 #include <sndfile.h>
 
 #include "utils.h"
+#include "defects4cpp.h"
 
 #define	DATA_LENGTH 		(512)
 
@@ -104,19 +105,32 @@ main (int argc, char **argv)
 		} ;
 
 	do_all = !strcmp (argv [1], "all") ;
+	int index = defects4cpp_test_index () ;
 
 	if (do_all || ! strcmp (argv [1], "wav"))
-	{	multi_file_test	("multi_wav.dat", wav_formats, ARRAY_LEN (wav_formats)) ;
+	{	switch (index) {
+			case 294:
+		multi_file_test	("multi_wav.dat", wav_formats, ARRAY_LEN (wav_formats)) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "aiff"))
-	{	multi_file_test	("multi_aiff.dat", aiff_formats, ARRAY_LEN (aiff_formats)) ;
+	{	switch (index) {
+			case 295:
+		multi_file_test	("multi_aiff.dat", aiff_formats, ARRAY_LEN (aiff_formats)) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "au"))
-	{	multi_file_test	("multi_au.dat", au_formats, ARRAY_LEN (au_formats)) ;
+	{	switch (index) {
+			case 296:
+		multi_file_test	("multi_au.dat", au_formats, ARRAY_LEN (au_formats)) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
diff --git a/tests/ogg_test.c b/tests/ogg_test.c
index 4b1be031..6f264b3b 100644
--- a/tests/ogg_test.c
+++ b/tests/ogg_test.c
@@ -28,6 +28,7 @@
 #include	<sndfile.h>
 
 #include	"utils.h"
+#include	"defects4cpp.h"
 
 #define	SAMPLE_RATE			44100
 #define	DATA_LENGTH			(SAMPLE_RATE / 8)
@@ -328,6 +329,8 @@ ogg_stereo_seek_test (const char * filename, int format)
 int
 main (void)
 {
+	switch (defects4cpp_test_index ()) {
+		case 297:
 	if (HAVE_EXTERNAL_LIBS)
 	{	ogg_short_test () ;
 		ogg_int_test () ;
@@ -340,5 +343,7 @@ main (void)
 	else
 		puts ("    No Ogg/Vorbis tests because Ogg/Vorbis support was not compiled in.") ;
 
+			break ;
+	}
 	return 0 ;
 } /* main */
diff --git a/tests/peak_chunk_test.c b/tests/peak_chunk_test.c
index 9e5332a1..37a135ad 100644
--- a/tests/peak_chunk_test.c
+++ b/tests/peak_chunk_test.c
@@ -31,6 +31,7 @@
 #include <sndfile.h>
 
 #include "utils.h"
+#include "defects4cpp.h"
 
 #define	BUFFER_LEN		(1 << 15)
 #define LOG_BUFFER_SIZE	1024
@@ -63,28 +64,41 @@ main (int argc, char *argv [])
 		} ;
 
 	do_all = ! strcmp (argv [1], "all") ;
+	int index = defects4cpp_test_index () ;
 
 	if (do_all || ! strcmp (argv [1], "wav"))
-	{	test_float_peak ("peak_float.wav", SF_FORMAT_WAV | SF_FORMAT_FLOAT) ;
+	{	switch (index) {
+			case 298:
+		test_float_peak ("peak_float.wav", SF_FORMAT_WAV | SF_FORMAT_FLOAT) ;
 		test_float_peak ("peak_float.wavex", SF_FORMAT_WAVEX | SF_FORMAT_FLOAT) ;
 		test_float_peak ("peak_float.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV | SF_FORMAT_FLOAT) ;
 
 		read_write_peak_test ("rw_peak.wav", SF_FORMAT_WAV | SF_FORMAT_FLOAT) ;
 		read_write_peak_test ("rw_peak.wavex", SF_FORMAT_WAVEX | SF_FORMAT_FLOAT) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "aiff"))
-	{	test_float_peak	("peak_float.aiff", SF_FORMAT_AIFF | SF_FORMAT_FLOAT) ;
+	{	switch (index) {
+			case 299:
+		test_float_peak	("peak_float.aiff", SF_FORMAT_AIFF | SF_FORMAT_FLOAT) ;
 
 		read_write_peak_test ("rw_peak.aiff", SF_FORMAT_AIFF | SF_FORMAT_FLOAT) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "caf"))
-	{	test_float_peak	("peak_float.caf", SF_FORMAT_CAF | SF_FORMAT_FLOAT) ;
+	{	switch (index) {
+			case 300:
+		test_float_peak	("peak_float.caf", SF_FORMAT_CAF | SF_FORMAT_FLOAT) ;
 
 		read_write_peak_test ("rw_peak.caf", SF_FORMAT_CAF | SF_FORMAT_FLOAT) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
diff --git a/tests/raw_test.c b/tests/raw_test.c
index 6728e368..44830d9c 100644
--- a/tests/raw_test.c
+++ b/tests/raw_test.c
@@ -31,6 +31,7 @@
 #include <sndfile.h>
 
 #include "utils.h"
+#include "defects4cpp.h"
 
 #define	BUFFER_LEN		(1 << 10)
 #define LOG_BUFFER_SIZE	1024
@@ -46,8 +47,14 @@ static	short	data [BUFFER_LEN] ;
 int
 main (void)
 {
+	switch (defects4cpp_test_index ()) {
+		case 301:
 	raw_offset_test ("offset.raw", SF_FORMAT_PCM_16) ;
+			break ;
+		case 302:
 	bad_raw_test () ;
+			break ;
+	}
 
 	return 0 ;
 } /* main */
diff --git a/tests/sftest.c b/tests/sftest.c
index 78a9f7fa..a4d511f5 100644
--- a/tests/sftest.c
+++ b/tests/sftest.c
@@ -25,6 +25,7 @@
 #endif
 
 #include <sndfile.h>
+#include "defects4cpp.h"
 
 #define	BUFFER_SIZE		(1024)
 
@@ -42,6 +43,8 @@ main (int argc, char *argv [])
 		return 0 ;
 		} ;
 
+	switch (defects4cpp_test_index ()) {
+		case 303:
 	if (! (file = sf_open (argv [1], SFM_READ, &sfinfo)))
 	{	printf ("sf_open_read failed with error : ") ;
 		puts (sf_strerror (NULL)) ;
@@ -60,6 +63,8 @@ main (int argc, char *argv [])
 
 	sf_close (file) ;
 
+			break ;
+	}
 	return 0 ;
 } /* main */
 
diff --git a/tests/stdin_test.c b/tests/stdin_test.c
index a893915c..7513c7d4 100644
--- a/tests/stdin_test.c
+++ b/tests/stdin_test.c
@@ -30,6 +30,7 @@
 #include <sndfile.h>
 
 #include "utils.h"
+#include "defects4cpp.h"
 
 #define	BUFFER_LEN		(1 << 16)
 
@@ -51,74 +52,131 @@ main (int argc, char *argv [])
 		} ;
 
 	do_all = ! strcmp (argv [1], "all") ;
+	int index = defects4cpp_test_index () ;
 
 	if (do_all || ! strcmp (argv [1], "raw"))
-	{	stdin_test	(SF_FORMAT_RAW, PIPE_TEST_LEN) ;
+	{	switch (index) {
+			case 304:
+		stdin_test	(SF_FORMAT_RAW, PIPE_TEST_LEN) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "wav"))
-	{	stdin_test	(SF_FORMAT_WAV, PIPE_TEST_LEN) ;
+	{	switch (index) {
+			case 305:
+		stdin_test	(SF_FORMAT_WAV, PIPE_TEST_LEN) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "aiff"))
-	{	stdin_test	(SF_FORMAT_AIFF, PIPE_TEST_LEN) ;
+	{	switch (index) {
+			case 306:
+		stdin_test	(SF_FORMAT_AIFF, PIPE_TEST_LEN) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "au"))
-	{	stdin_test	(SF_FORMAT_AU, PIPE_TEST_LEN) ;
+	{	switch (index) {
+			case 307:
+		stdin_test	(SF_FORMAT_AU, PIPE_TEST_LEN) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "paf"))
-	{	stdin_test	(SF_FORMAT_PAF, PIPE_TEST_LEN) ;
+	{	switch (index) {
+			case 308:
+		stdin_test	(SF_FORMAT_PAF, PIPE_TEST_LEN) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "svx"))
-	{	stdin_test	(SF_FORMAT_SVX, PIPE_TEST_LEN) ;
+	{	switch (index) {
+			case 309:
+		stdin_test	(SF_FORMAT_SVX, PIPE_TEST_LEN) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "nist"))
-	{	stdin_test	(SF_FORMAT_NIST, PIPE_TEST_LEN) ;
+	{	switch (index) {
+			case 310:
+		stdin_test	(SF_FORMAT_NIST, PIPE_TEST_LEN) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "ircam"))
-	{	stdin_test	(SF_FORMAT_IRCAM, PIPE_TEST_LEN) ;
+	{	switch (index) {
+			case 311:
+		stdin_test	(SF_FORMAT_IRCAM, PIPE_TEST_LEN) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "voc"))
-	{	stdin_test	(SF_FORMAT_VOC, PIPE_TEST_LEN) ;
+	{	switch (index) {
+			case 312:
+		stdin_test	(SF_FORMAT_VOC, PIPE_TEST_LEN) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "w64"))
-	{	stdin_test	(SF_FORMAT_W64, PIPE_TEST_LEN) ;
+	{	switch (index) {
+			case 313:
+		stdin_test	(SF_FORMAT_W64, PIPE_TEST_LEN) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "mat4"))
-	{	stdin_test	(SF_FORMAT_MAT4, PIPE_TEST_LEN) ;
+	{	switch (index) {
+			case 314:
+		stdin_test	(SF_FORMAT_MAT4, PIPE_TEST_LEN) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "mat5"))
-	{	stdin_test	(SF_FORMAT_MAT5, PIPE_TEST_LEN) ;
+	{	switch (index) {
+			case 315:
+		stdin_test	(SF_FORMAT_MAT5, PIPE_TEST_LEN) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "pvf"))
-	{	stdin_test	(SF_FORMAT_PVF, PIPE_TEST_LEN) ;
+	{	switch (index) {
+			case 316:
+		stdin_test	(SF_FORMAT_PVF, PIPE_TEST_LEN) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "htk"))
-	{	stdin_test	(SF_FORMAT_HTK, PIPE_TEST_LEN) ;
+	{	switch (index) {
+			case 317:
+		stdin_test	(SF_FORMAT_HTK, PIPE_TEST_LEN) ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
diff --git a/tests/string_test.c b/tests/string_test.c
index eac716e8..9cb22826 100644
--- a/tests/string_test.c
+++ b/tests/string_test.c
@@ -31,6 +31,7 @@
 #include	<sndfile.h>
 
 #include	"utils.h"
+#include	"defects4cpp.h"
 
 #define	BUFFER_LEN			(1 << 10)
 #define LOG_BUFFER_SIZE		1024
@@ -64,31 +65,66 @@ main (int argc, char *argv [])
 		} ;
 
 	do_all = ! strcmp (argv [1], "all") ;
+	int index = defects4cpp_test_index () ;
 
 	if (do_all || ! strcmp (argv [1], "wav"))
-	{	string_start_end_test ("strings.wav", SF_FORMAT_WAV) ;
+	{	switch (index) {
+			case 318:
+		string_start_end_test ("strings.wav", SF_FORMAT_WAV) ;
+				break ;
+			case 319:
 		string_multi_set_test ("multi.wav", SF_FORMAT_WAV) ;
+				break ;
+			case 320:
 		string_rdwr_test ("rdwr.wav", SF_FORMAT_WAV) ;
+				break ;
+			case 321:
 		string_short_rdwr_test ("short_rdwr.wav", SF_FORMAT_WAV) ;
+				break ;
+			case 322:
 		string_rdwr_grow_test ("rdwr_grow.wav", SF_FORMAT_WAV) ;
+				break ;
+			case 323:
 		string_header_update ("header_update.wav", SF_FORMAT_WAV) ;
 
+				break ;
+			case 324:
 		string_start_end_test ("strings.wavex", SF_FORMAT_WAVEX) ;
+				break ;
+			case 325:
 		string_multi_set_test ("multi.wavex", SF_FORMAT_WAVEX) ;
+				break ;
+			case 326:
 		string_rdwr_test ("rdwr.wavex", SF_FORMAT_WAVEX) ;
+				break ;
+			case 327:
 		string_short_rdwr_test ("short_rdwr.wavex", SF_FORMAT_WAVEX) ;
 
+				break ;
+			case 328:
 		string_start_end_test ("strings.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV) ;
+				break ;
+			case 329:
 		string_multi_set_test ("multi.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV) ;
+				break ;
+			case 330:
 		string_rdwr_test ("rdwr.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV) ;
+				break ;
+			case 331:
 		string_short_rdwr_test ("short_rdwr.rifx", SF_ENDIAN_BIG | SF_FORMAT_WAV) ;
 
+				break ;
+			case 332:
 		software_string_test ("software_string.wav") ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "aiff"))
-	{	string_start_end_test ("strings.aiff", SF_FORMAT_AIFF) ;
+	{	switch (index) {
+			case 333:
+		string_start_end_test ("strings.aiff", SF_FORMAT_AIFF) ;
 		/*
 		TODO : Fix src/aiff.c so these tests pass.
 		string_multi_set_test ("multi.aiff", SF_FORMAT_AIFF) ;
@@ -98,33 +134,47 @@ main (int argc, char *argv [])
 		string_header_update ("header_update.aiff", SF_FORMAT_AIFF) ;
 		*/
 
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "flac"))
-	{	if (HAVE_EXTERNAL_LIBS)
+	{	switch (index) {
+			case 334:
+		if (HAVE_EXTERNAL_LIBS)
 			string_start_test ("strings.flac", SF_FORMAT_FLAC) ;
 		else
 			puts ("    No FLAC tests because FLAC support was not compiled in.") ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "ogg"))
-	{	if (HAVE_EXTERNAL_LIBS)
+	{	switch (index) {
+			case 335:
+		if (HAVE_EXTERNAL_LIBS)
 			string_start_test ("vorbis.oga", SF_FORMAT_OGG) ;
 		else
 			puts ("    No Ogg/Vorbis tests because Ogg/Vorbis support was not compiled in.") ;
+				break ;
+		}
 		test_count++ ;
 		} ;
 
 	if (do_all || ! strcmp (argv [1], "rf64"))
-	{	puts ("\n\n     **** String test not working yet for RF64 format. ****\n") ;
+	{	switch (index) {
+			case 336:
+		puts ("\n\n	   **** String test not working yet for RF64 format. ****\n") ;
 		/*
 		string_start_end_test ("strings.rf64", SF_FORMAT_RF64) ;
 		string_multi_set_test ("multi.rf64", SF_FORMAT_RF64) ;
 		string_rdwr_test ("rdwr.rf64", SF_FORMAT_RF64) ;
 		string_short_rdwr_test ("short_rdwr.rf64", SF_FORMAT_RF64) ;
 		*/
+				break ;
+		}
 		test_count++ ;
 		} ;
 
diff --git a/tests/ulaw_test.c b/tests/ulaw_test.c
index fc0d497a..6fa2de27 100644
--- a/tests/ulaw_test.c
+++ b/tests/ulaw_test.c
@@ -29,6 +29,7 @@
 #include <sndfile.h>
 
 #include "utils.h"
+#include "defects4cpp.h"
 
 #define	BUFFER_SIZE		(65536)
 
@@ -51,6 +52,9 @@ main (void)
 
 	sf_info_setup (&sfinfo, SF_FORMAT_RAW | SF_FORMAT_ULAW, 44100, 1) ;
 
+	switch (defects4cpp_test_index ())
+	{
+		case 337:
 	if ((file = sf_open (filename, SFM_WRITE, &sfinfo)) == NULL)
 	{	printf ("sf_open_write failed with error : ") ;
 		fflush (stdout) ;
@@ -144,6 +148,8 @@ main (void)
 	puts ("ok") ;
 
 	unlink (filename) ;
+			break ;
+	}
 
 	return 0 ;
 } /* main */
diff --git a/tests/virtual_io_test.c b/tests/virtual_io_test.c
index 1aae063d..39f78d3e 100644
--- a/tests/virtual_io_test.c
+++ b/tests/virtual_io_test.c
@@ -30,16 +30,28 @@
 #include <sndfile.h>
 
 #include "utils.h"
+#include "defects4cpp.h"
 
 static void vio_test (const char *fname, int format) ;
 
 int
 main (void)
 {
+	switch (defects4cpp_test_index ())
+	{
+		case 338:
 	vio_test ("vio_pcm16.wav", SF_FORMAT_WAV | SF_FORMAT_PCM_16) ;
+			break ;
+		case 339:
 	vio_test ("vio_pcm24.aiff", SF_FORMAT_AIFF | SF_FORMAT_PCM_24) ;
+			break ;
+		case 340:
 	vio_test ("vio_float.au", SF_FORMAT_AU | SF_FORMAT_FLOAT) ;
+			break ;
+		case 341:
 	vio_test ("vio_pcm24.paf", SF_FORMAT_PAF | SF_FORMAT_PCM_24) ;
+			break ;
+	}
 
 	return 0 ;
 } /* main */
diff --git a/tests/win32_ordinal_test.c b/tests/win32_ordinal_test.c
index 5324a2ed..f76e8e6a 100644
--- a/tests/win32_ordinal_test.c
+++ b/tests/win32_ordinal_test.c
@@ -34,6 +34,7 @@
 #include <sys/types.h>
 
 #include "utils.h"
+#include "defects4cpp.h"
 
 #if (defined (WIN32) || defined (_WIN32) || defined (__CYGWIN__))
 #define TEST_WIN32		1
@@ -136,9 +137,14 @@ win32_ordinal_test (void)
 int
 main (void)
 {
+	switch (defects4cpp_test_index ())
+	{
+		case 342:
 #if (TEST_WIN32 && WIN32_TARGET_DLL)
 	win32_ordinal_test () ;
 #endif
+			break ;
+	}
 
 	return 0 ;
 } /* main */
diff --git a/tests/win32_test.c b/tests/win32_test.c
index d0dc6d8e..ddb0a001 100644
--- a/tests/win32_test.c
+++ b/tests/win32_test.c
@@ -18,6 +18,7 @@
 
 #include "sfconfig.h"
 #include "sndfile.h"
+#include "defects4cpp.h"
 
 #include <stdio.h>
 #include <stdlib.h>
@@ -88,10 +89,15 @@ main (void)
 		"other OSes just to provide a sanity check.\n"
 		) ;
 
+	switch (defects4cpp_test_index ())
+	{
+		case 343:
 	show_fstat_error () ;
 	show_lseek_error () ;
 	show_stat_fstat_error () ;
 	write_to_closed_file () ;
+			break ;
+	}
 
 	puts ("\n\n") ;
 
-- 
2.25.1

